# Order Service

–ú–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞–º–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Go**, **PostgreSQL**, **Apache Kafka** –∏ **in-memory –∫—ç—à–∞**.

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üì• –ü—Ä–∏–µ–º –∑–∞–∫–∞–∑–æ–≤ —á–µ—Ä–µ–∑ **Apache Kafka**
- ‚ö° In-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ (`sync.Map`)
- üåê **RESTful API** –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
- üñ•Ô∏è –í–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –∑–∞–∫–∞–∑–æ–≤
- üìä –ë–µ–Ω—á–º–∞—Ä–∫–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫—ç—à–∞ vs –ë–î
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞ –∏–∑ –ë–î
- üåç –ü–æ–¥–¥–µ—Ä–∂–∫–∞ **CORS**

---

## üõ† –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- **Docker** –∏ **Docker Compose** ‚Äî –¥–ª—è –∑–∞–ø—É—Å–∫–∞ Kafka
- **Go 1.21+** ‚Äî –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
- **PostgreSQL** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å–∫ Kafka –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ Zookeeper, Kafka –∏ Kafka UI
docker-compose up -d
```
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Å–µ—Ä–≤–∏—Å—ã –∑–∞–ø—É—â–µ–Ω—ã:

Kafka UI: http://localhost:8082

Kafka Broker: localhost:9092

Zookeeper: localhost:2181

### 2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç–∞
```cd order-service```

### 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
```go mod download```

### 4. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
```go run cmd/orderservice/main.go```

# –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é Order Service

## üéØ –û–±–∑–æ—Ä —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç unit-—Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö –æ—Å–Ω–æ–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤:
- –ö—ç—à –∑–∞–∫–∞–∑–æ–≤ (`internal/cache/`)
- –°–µ—Ä–≤–∏—Å–Ω—ã–π —Å–ª–æ–π (`internal/service/`) 
- HTTP —Ö–µ–Ω–¥–ª–µ—Ä—ã (`internal/handler/`)

## üß™ –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤

### 1. –¢–µ—Å—Ç—ã –∫—ç—à–∞ (`cache_simple_test.go`)
- **TestCacheBasicOperations**: –±–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ, –ø–æ–ª—É—á–µ–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ)
- **TestCacheSize**: –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∫—ç—à–∞
- **TestCacheExpiration**: –ø—Ä–æ–≤–µ—Ä–∫–∞ TTL (–≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –∑–∞–ø–∏—Å–µ–π)

### 2. –¢–µ—Å—Ç—ã —Ö–µ–Ω–¥–ª–µ—Ä–æ–≤ (`handler_simple_test.go`)
- **TestOrderHandlerFound**: —É—Å–ø–µ—à–Ω—ã–π –ø–æ–∏—Å–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–∫–∞–∑–∞
- **TestOrderHandlerNotFound**: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∑–∞–∫–∞–∑–∞ (404)
- **TestCacheHandler**: –ø–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–∑–º–µ—Ä–µ –∫—ç—à–∞
- **TestHealthHandler**: –ø—Ä–æ–≤–µ—Ä–∫–∞ health check endpoint

### 3. –¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–∞ (`service_simple_test.go`)
- **TestValidation**: –≤–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–∫–∞–∑–æ–≤
- **TestJSONParsing**: –ø–∞—Ä—Å–∏–Ω–≥ JSON —Å–æ–æ–±—â–µ–Ω–∏–π
- **TestEmptyMessage**: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—É—Å—Ç—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- **TestGetOrderFromCache**: –ø–æ–ª—É—á–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ –∏–∑ –∫—ç—à–∞
- **TestValidatorService**: —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ –∑–∞–∫–∞–∑–æ–≤

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í–∞—Ä–∏–∞–Ω—Ç 1: –í—Å–µ —Ç–µ—Å—Ç—ã
```bash
go test ./internal/... -v

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º
```bash
# –¢–æ–ª—å–∫–æ –∫—ç—à
go test ./internal/cache/ -v

# –¢–æ–ª—å–∫–æ —Ö–µ–Ω–¥–ª–µ—Ä—ã  
go test ./internal/handler/ -v

# –¢–æ–ª—å–∫–æ —Å–µ—Ä–≤–∏—Å
go test ./internal/service/ -v```

–í–∞—Ä–∏–∞–Ω—Ç 3: –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ç–µ—Å—Ç—ã
```bash
# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
go test ./internal/service/ -run TestValidation -v

# –¢–æ–ª—å–∫–æ —Ç–µ—Å—Ç—ã –∫—ç—à–∞
go test ./internal/cache/ -run TestCache -v```

–í–∞—Ä–∏–∞–Ω—Ç 4: –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
```bash
chmod +x run_simple_tests.sh
./run_simple_tests.sh```
